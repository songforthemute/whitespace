---
import Nav from "@/components/Nav.astro";
import { SITE } from "@/config";

interface Props {
	title: string;
	description?: string;
}

const { title, description = `${SITE.name} - ${SITE.author}'s Web Logs` } = Astro.props;
const siteTitle = title === "Home" ? SITE.name : `${title} | ${SITE.name}`;
const ogTitle = title === "Home" ? SITE.name : title;
const ogImageUrl = `${SITE.url}/api/og-image?title=${encodeURIComponent(ogTitle)}`;
const canonicalUrl = Astro.url.href.replace(Astro.url.origin, SITE.url);
---

<!doctype html>
<html lang={SITE.language}>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content={description} />
		<title>{siteTitle}</title>
		<link rel="canonical" href={canonicalUrl} />
		<meta property="og:title" content={ogTitle} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={ogImageUrl} />
		<meta property="og:url" content={canonicalUrl} />
		<meta property="og:type" content="article" />
		<meta name="twitter:card" content="summary_large_image" />
		<link rel="stylesheet" href="/styles/layout.css" />
		<link rel="stylesheet" href="/pagefind/pagefind-ui.css" />
		<link rel="alternate" type="application/rss+xml" title={`${SITE.name} RSS`} href="/feed.xml" />
	</head>
	<body>
		<header>
			<Nav />
			<div id="search"></div>
		</header>
		<script>
			window.addEventListener("DOMContentLoaded", () => {
				// @ts-ignore
				new PagefindUI({
					element: "#search",
					showSubResults: true,
					translations: {
						placeholder: "Search",
						clear_search: "Clear",
						load_more: "Load more results",
						zero_results: "No results for [SEARCH_TERM]",
						many_results: "[COUNT] results for [SEARCH_TERM]",
						one_result: "[COUNT] result for [SEARCH_TERM]",
						searching: "Searching for [SEARCH_TERM]...",
					},
				});
			});
		</script>
		<script src="/pagefind/pagefind-ui.js" is:inline></script>
		<main>
			<slot />
		</main>
		<footer>
			<p>&copy; {new Date().getFullYear()} {SITE.author} Â· <a href="/feed.xml">RSS</a></p>
		</footer>
	</body>
</html>
